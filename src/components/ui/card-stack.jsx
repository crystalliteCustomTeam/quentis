"use client";
import { useEffect, useState } from "react";
import { motion } from "framer-motion";

let interval;

export const CardStack = ({ items, offset, scaleFactor }) => {
  const CARD_OFFSET = offset || 25;
  const SCALE_FACTOR = scaleFactor || 0.08;
  const [cards, setCards] = useState(items);

  useEffect(() => {
    startFlipping();

    return () => clearInterval(interval);
  }, []);
  const startFlipping = () => {
    interval = setInterval(() => {
      setCards((prevCards) => {
        const newArray = [...prevCards]; // create a copy of the array
        newArray.unshift(newArray.pop()); // move the last element to the front
        return newArray;
      });
    }, 4000);
  };

  return (
    <div className="relative w-full h-[430px] sm:h-[350px] mt-10">
      {cards.map((card, index) => {
        return (
          <motion.div
            key={index}
            className="absolute bg-white px-5 sm:px-10  h-full flex flex-col justify-center border-[3px] border-[#2C2F35] rounded-3xl"
            style={{
              transformOrigin: "bottom center",
            }}
            animate={{
              bottom: index * -CARD_OFFSET,
              scale: 1 - index * SCALE_FACTOR, // decrease scale for cards that are behind
              zIndex: cards.length - index, //  decrease z-index for the cards that are behind
            }}>
            <div>
              <p className="text-[16px] md:text-[20px] leading-relaxed mb-5">"{card.para}"</p>
            </div>
            <div className="flex items-center gap-5">
              <div className="bg-primary w-[80px] h-[80px] rounded-full flex items-center justify-center text-[40px] text-card font-bold">
                {card.name
                  ?.split(" ")
                  .map((word) => word[0]?.toUpperCase())
                  .join("")}
              </div>
              <div>
                <div>
                  <p className="text-[16px] md:text-[20px] leading-snug font-semibold mb-2">
                    {card.name}, <span className="text-primary">{card.jd}</span>
                  </p>
                  <svg width="140" height="22" viewBox="0 0 140 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M13.0241 2.12178L14.8547 5.78293C15.1014 6.28926 15.7635 6.76962 16.3218 6.87349L19.6324 7.41876C21.7486 7.7693 22.2419 9.30127 20.7229 10.8332L18.1394 13.4168C17.7109 13.8453 17.4643 14.6891 17.6071 15.2993L18.3471 18.4931C18.9313 21.0118 17.5811 21.9985 15.361 20.6742L12.2582 18.8307C11.6999 18.4931 10.7651 18.4931 10.2069 18.8307L7.10397 20.6742C4.88391 21.9855 3.5337 21.0118 4.11793 18.4931L4.85795 15.2993C4.97479 14.6762 4.72812 13.8323 4.29969 13.4038L1.71611 10.8203C0.197117 9.30127 0.690464 7.7693 2.80666 7.40578L6.11728 6.8605C6.67554 6.76962 7.33766 6.27628 7.58434 5.76995L9.41491 2.10879C10.4146 0.135405 12.0245 0.135405 13.0241 2.12178Z"
                      fill="#F3E226"
                    />
                    <path
                      d="M42.4499 2.12178L44.2805 5.78293C44.5272 6.28926 45.1893 6.76962 45.7476 6.87349L49.0582 7.41876C51.1744 7.7693 51.6677 9.30127 50.1487 10.8332L47.5651 13.4168C47.1367 13.8453 46.89 14.6891 47.0329 15.2993L47.7729 18.4931C48.3571 21.0118 47.0069 21.9985 44.7868 20.6742L41.6839 18.8307C41.1257 18.4931 40.1909 18.4931 39.6326 18.8307L36.5298 20.6742C34.3097 21.9855 32.9595 21.0118 33.5437 18.4931L34.2837 15.2993C34.4006 14.6762 34.1539 13.8323 33.7255 13.4038L31.1419 10.8203C29.6229 9.30127 30.1162 7.7693 32.2324 7.40578L35.5431 6.8605C36.1013 6.76962 36.7634 6.27628 37.0101 5.76995L38.8407 2.10879C39.8404 0.135405 41.4502 0.135405 42.4499 2.12178Z"
                      fill="#F3E226"
                    />
                    <path
                      d="M71.8757 2.12178L73.7063 5.78293C73.9529 6.28926 74.6151 6.76962 75.1733 6.87349L78.4839 7.41876C80.6001 7.7693 81.0935 9.30127 79.5745 10.8332L76.9909 13.4168C76.5625 13.8453 76.3158 14.6891 76.4586 15.2993L77.1987 18.4931C77.7829 21.0118 76.4327 21.9985 74.2126 20.6742L71.1097 18.8307C70.5515 18.4931 69.6167 18.4931 69.0584 18.8307L65.9555 20.6742C63.7355 21.9855 62.3853 21.0118 62.9695 18.4931L63.7095 15.2993C63.8264 14.6762 63.5797 13.8323 63.1512 13.4038L60.5677 10.8203C59.0487 9.30127 59.542 7.7693 61.6582 7.40578L64.9688 6.8605C65.5271 6.76962 66.1892 6.27628 66.4359 5.76995L68.2665 2.10879C69.2662 0.135405 70.876 0.135405 71.8757 2.12178Z"
                      fill="#F3E226"
                    />
                    <path
                      d="M101.301 2.12178L103.132 5.78293C103.379 6.28926 104.041 6.76962 104.599 6.87349L107.91 7.41876C110.026 7.7693 110.519 9.30127 109 10.8332L106.417 13.4168C105.988 13.8453 105.742 14.6891 105.884 15.2993L106.624 18.4931C107.209 21.0118 105.858 21.9985 103.638 20.6742L100.535 18.8307C99.9772 18.4931 99.0425 18.4931 98.4842 18.8307L95.3813 20.6742C93.1613 21.9855 91.811 21.0118 92.3953 18.4931L93.1353 15.2993C93.2521 14.6762 93.0055 13.8323 92.577 13.4038L89.9935 10.8203C88.4745 9.30127 88.9678 7.7693 91.084 7.40578L94.3946 6.8605C94.9529 6.76962 95.615 6.27628 95.8617 5.76995L97.6923 2.10879C98.6919 0.135405 100.302 0.135405 101.301 2.12178Z"
                      fill="#F3E226"
                    />
                    <path
                      d="M130.727 2.12178L132.558 5.78293C132.805 6.28926 133.467 6.76962 134.025 6.87349L137.336 7.41876C139.452 7.7693 139.945 9.30127 138.426 10.8332L135.842 13.4168C135.414 13.8453 135.167 14.6891 135.31 15.2993L136.05 18.4931C136.634 21.0118 135.284 21.9985 133.064 20.6742L129.961 18.8307C129.403 18.4931 128.468 18.4931 127.91 18.8307L124.807 20.6742C122.587 21.9855 121.237 21.0118 121.821 18.4931L122.561 15.2993C122.678 14.6762 122.431 13.8323 122.003 13.4038L119.419 10.8203C117.9 9.30127 118.394 7.7693 120.51 7.40578L123.82 6.8605C124.379 6.76962 125.041 6.27628 125.287 5.76995L127.118 2.10879C128.118 0.135405 129.728 0.135405 130.727 2.12178Z"
                      fill="#F3E226"
                    />
                  </svg>
                </div>
              </div>
            </div>
          </motion.div>
        );
      })}
    </div>
  );
};
